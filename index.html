<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer" />
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href="css/default.css">
    <title>Grayfen's Canvas</title>
    <meta name="keywords" content="UI设计师/插画师">
    <meta name="description" content="Grayfen的个人画展">
</head>

<body>
    <div id="mainpart">
        <div class="thetitle">
            <h1 class="title">Grayfen's Canvas</h1>
            <button id="switch"></button>
        </div>
        <div class="slogen">分享作品和设计</div>
        <div class="zcool">
            <a class="link" href="https://www.zcool.com.cn/u/16736676" target="_blank" name="站酷主页"></a>
        </div>
        <div class="tabs">
            <div class="tab active" data-tab="images">图片</div>
            <div class="tab" data-tab="comments">评论</div>
        </div>
        <div id="image-content" class="tab-content active">
            <h2>图片展示</h2>
            <ul id="works"></ul>
            <div class="loadmorepic">
                <span id="more">滚动加载更多...</span>
                <span id="nums">
                    <span id="loadpic"></span>
                    <span class="and">/</span>
                    <span id="allpic"></span>
                </span>
            </div>
        </div>
        <div id="comment-content" class="tab-content">
            <h2>随笔列表</h2>
            <ul id="comment-list"></ul>
        </div>
    </div>
    <!-- The Modal -->
    <div id="myModal" class="modal">
        <span class="close">×</span>
        <img class="modal-content" id="img01" onclick="look(this);">
    </div>
    <footer>
        <div class="links">友情链接：
            <a href="https://www.leoon.cn/" target="_blank" > Leoon Liang </a>
            <a href="https://kooritea.moe/" target="_blank"> 冰茶的糖果罐 </a>
            <a href="https://www.yuanmoc.cn/" target="_blank"> Yuanmoc </a>
            <a href="https://weitheworld.cn/" target="_blank"> Lusir's Blog </a>
            <a href="https://www.d1n910.com/" target="_blank" style="pointer-events:none;color:#939393;text-decoration-line: line-through;"> 蛋糕博客(已失效) </a>
        </div>
        <div class="links">特别鸣谢：
            <a href="https://wangyuan.info/" target="_blank"> 网园资讯工作室 </a>
        </div>
        <div class="information">Copyright © 2019-2024 Grayfen 桂峰</div>
        <div class="links">
            <a href="http://beian.miit.gov.cn" target="_blank">粤ICP备19034456号</a>
        </div>
        <div class="links">
            <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44060502003152" target="_blank">
                <img src="beian.png" />粤公网安备 44060502003152号
            </a>
        </div>
    </footer>
</body>
<script src="js/imagearray.js"></script>
<script src="js/marked.min.js"></script>
<script>
    // 切换标签页
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
      const targetTab = tab.getAttribute('data-tab');
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      tab.classList.add('active');
      console.log(targetTab);
      document.getElementById(targetTab).classList.add('active');
  });
});
    async function loadComments() {
        try {
            // 替换为你的GitHub用户名、仓库名称和Issue编号
            const owner = "GrayfenXie";
            const repo = "GrayfenXie.github.io";
            const issueNumber = "2"; // 替换为目标Issue的编号

            const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/issues/${issueNumber}/comments`);
            if (!response.ok) {
                throw new Error(`Failed to fetch comments: ${response.statusText}`);
            }
            const comments = await response.json();
            const commentList = document.getElementById('comment-list');

            // 清空之前的评论内容
            commentList.innerHTML = '';

            // 遍历评论数组，动态生成HTML内容
            comments.forEach(comment => {
                const li = document.createElement('li');
                    const date = new Date(comment.created_at); // 解析时间戳
                    const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`; // 格式化日期和时间
                    // 使用marked.js将Markdown转换为HTML
                    const bodyHTML = marked(comment.body);
                    li.innerHTML = `
                        <div class="comment-body">${bodyHTML}</div>
                        <div class="comment-date">${formattedDate}</div>
                    `;
                    commentList.appendChild(li);
            });
        } catch (error) {
            console.error('Failed to load comments:', error);
            document.getElementById('comment-list').innerHTML = '<li>加载评论失败，请稍后再试。</li>';
        }
    }

    // 调用函数加载评论
    loadComments();
</script>
</html>
